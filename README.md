# 智能排班表制作器 V2

## 项目简介

智能排班表制作器是一个专业的企业排班管理系统，支持差异化休息分配、智能班次安排和完整的排班统计功能。

## 功能特性

### 核心功能
- **智能排班算法**: 自动生成符合企业规则的排班表
- **夜班轮换机制**: 老员工严格按顺序轮换夜班
- **差异化休息分配**: 老员工2天/月，新员工和暑假工6天/月
- **班次人数保障**: 确保每个班次有足够人员
- **特殊安排支持**: 支持员工特殊休息需求
- **完整统计报告**: 工作天数、休息天数、夜班补助等

### 排班规则
1. 夜班严格由老员工郭→朱→伊→邵轮流担任
2. 值夜班后次日必须休息
3. 白班和中班保证至少2人
4. 赵员工只安排在白班
5. 秦员工可值白班和中班
6. 暑假工可值白班和中班（7月加入）
7. 老员工值夜班有¥30补助
8. 差异化休息：老员工每月最多2天，新员工每月目标6天

## 系统要求

- Python 3.8+
- pandas >= 1.3.0
- openpyxl >= 3.0.0

## 文件说明

- `最终优化排班脚本.py`: 核心排班算法脚本
- `最终优化七月排班表.xlsx`: 生成的Excel排班表
- `最终优化排班数据.json`: 排班数据JSON格式
- `start.py`: 启动脚本
- `requirements.txt`: 依赖包列表
- `deployment_config.json`: 部署配置文件
- `mcp_config.json`: MCP服务器配置

## 使用方法

### 1. 环境准备
```bash
# 安装依赖
pip install -r requirements.txt
```

### 2. 运行排班脚本
```bash
# 直接运行核心脚本
python 最终优化排班脚本.py

# 或使用启动脚本
python start.py
```

### 3. 查看结果
- Excel排班表: `最终优化七月排班表.xlsx`
- JSON数据: `最终优化排班数据.json`
- 控制台输出: 详细的排班统计信息

## 排班统计

### 基本信息
- **排班期间**: 2025年6月23日至7月31日
- **总天数**: 39天
- **员工配置**: 9人（老员工4人，新员工3人，暑假工2人）

### 工作分配
- **夜班分配**: 郭10次，朱10次，伊10次，邵9次
- **总夜班补助**: ¥1170
- **老员工工作天数**: 29天
- **新员工工作天数**: 28天
- **暑假工工作天数**: 28天（7月加入）

### 休息分配
- **老员工休息**: 每人2天/月
- **新员工休息**: 每人3天/月
- **暑假工休息**: 每人3天/月

## 技术特点

### 算法优势
- **智能优先级排序**: 新员工和暑假工休息优先级更高
- **动态人数调整**: 根据可用人员动态调整班次安排
- **强制休息机制**: 确保休息不足的员工优先获得休息
- **班次人数保障**: 自动确保每个班次有足够人员

### 数据输出
- **Excel格式**: 专业的排班表格式，支持打印
- **JSON格式**: 便于系统集成和数据处理
- **统计报告**: 完整的工作量和休息统计

## 配置说明

### 员工配置
```python
employees = {
    '郭': {'type': 'old', 'shifts': ['白班', '中班', '夜班']},
    '朱': {'type': 'old', 'shifts': ['白班', '中班', '夜班']},
    '伊': {'type': 'old', 'shifts': ['白班', '中班', '夜班']},
    '邵': {'type': 'old', 'shifts': ['白班', '中班', '夜班']},
    '赵': {'type': 'new', 'shifts': ['白班']},
    '秦': {'type': 'new', 'shifts': ['白班', '中班']},
    '暑假工1': {'type': 'temp', 'shifts': ['白班', '中班']},
    '暑假工2': {'type': 'temp', 'shifts': ['白班', '中班']},
    '赵2': {'type': 'new', 'shifts': ['白班']}
}
```

### 班次时间
- **白班**: 8:30-17:30
- **中班**: 13:30-22:30
- **夜班**: 22:30-8:30

## 更新日志

### V2.0.0 (2025-06-30)
- 优化休息分配算法
- 增加差异化休息策略
- 改进班次人数保障机制
- 完善统计报告功能
- 支持MCP服务器部署

## 许可证

MIT License

## 联系方式

- 项目维护: 郭晟钰
- 技术支持: 1207248662@qq.com

---

**注意**: 本系统专为企业排班管理设计，请根据实际需求调整员工配置和排班规则。